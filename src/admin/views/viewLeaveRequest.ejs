<!DOCTYPE html>
<html class="loading dark-layout" lang="en" data-layout="dark-layout" data-textdirection="ltr">
<!-- BEGIN: Head-->

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=0,minimal-ui">
    <meta name="description"
        content="Vuexy admin is super flexible, powerful, clean &amp; modern responsive bootstrap 4 admin template with unlimited possibilities.">
    <meta name="keywords"
        content="admin template, Vuexy admin template, dashboard template, flat admin template, responsive admin template, web app">
    <meta name="author" content="PIXINVENT">
    <title>Kanban - Vuexy - Bootstrap HTML admin template</title>
    <link rel="apple-touch-icon" href="../../../app-assets/images/ico/apple-icon-120.png">
    <link rel="shortcut icon" type="image/x-icon" href="../../../app-assets/images/ico/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,300;0,400;0,500;0,600;1,400;1,500;1,600"
        rel="stylesheet">

    <!-- BEGIN: Vendor CSS-->
    <link rel="stylesheet" type="text/css" href="../../../app-assets/vendors/css/vendors.min.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/vendors/css/jkanban/jkanban.min.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/vendors/css/pickers/flatpickr/flatpickr.min.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/vendors/css/forms/select/select2.min.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/vendors/css/editors/quill/katex.min.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/vendors/css/editors/quill/monokai-sublime.min.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/vendors/css/editors/quill/quill.snow.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/vendors/css/editors/quill/quill.bubble.css">
    <!-- END: Vendor CSS-->

    <!-- BEGIN: Theme CSS-->
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/bootstrap-extended.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/colors.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/components.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/themes/dark-layout.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/themes/bordered-layout.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/themes/semi-dark-layout.css">

    <!-- BEGIN: Page CSS-->
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/core/menu/menu-types/vertical-menu.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/plugins/forms/pickers/form-flat-pickr.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/plugins/forms/form-quill-editor.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/plugins/forms/form-validation.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/pages/app-kanban.css">
    <!-- END: Page CSS-->

    <!-- BEGIN: Custom CSS-->
    <link rel="stylesheet" type="text/css" href="../../../assets/css/style.css">
    <!-- END: Custom CSS-->

</head>
<!-- END: Head-->

<!-- BEGIN: Body-->

<body class="vertical-layout vertical-menu-modern  navbar-floating footer-static  " data-open="click"
    data-menu="vertical-menu-modern" data-col="">

    <!-- BEGIN: Header-->
    <%-include("./partials/header") %>
        <!-- END: Header-->


        <!-- BEGIN: Main Menu-->
        <%-include("./partials/sidebar") %>
            <!-- END: Main Menu-->

            <!-- BEGIN: Content-->
            <div class="app-content content kanban-application">
                <div class="content-overlay"></div>
                <div class="header-navbar-shadow"></div>
                <div class="content-wrapper container-xxl p-0">
                    <div class="content-header row">
                    </div>
                    <div class="content-body">
                        <section id="basic-datatable">
                            <div class="row">
                                <div class="col-12">
                                    <div class="card">
                                        <div id="DataTables_Table_0_wrapper"
                                            class="dataTables_wrapper dt-bootstrap5 no-footer">
                                            <div class="card-header border-bottom p-1">
                                                <div class="head-label">
                                                    <h6 class="mb-0">Leave Management </h6>
                                                </div>
                                            </div>
                                            
                                            <table class="datatables-basic table dataTable no-footer dtr-column"
                                                id="leaveTable" role="grid" aria-describedby="DataTables_Table_0_info"
                                                style="width: 1036px;">
                                                <thead>
                                                    <tr role="row">
                                                        <!-- <th class="control sorting_disabled" rowspan="1" colspan="1"
                                                            style="width: 24px; display: none;" aria-label=""></th>
                                                        <th class="sorting_disabled dt-checkboxes-cell dt-checkboxes-select-all"
                                                            rowspan="1" colspan="1" style="width: 24px;" data-col="1"
                                                            aria-label="">
                                                            <div class="form-check"> <input class="form-check-input"
                                                                    type="checkbox" value=""
                                                                    id="checkboxSelectAll"><label
                                                                    class="form-check-label"
                                                                    for="checkboxSelectAll"></label></div>
                                                        </th> -->
                                                        <th class="sorting" tabindex="0"
                                                            aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                            style="width: 92px;"
                                                            aria-label="ID: activate to sort column ascending">EMPLOYEE
                                                            ID
                                                        </th>
                                                        <!-- <th class="sorting" tabindex="0"
                                                            aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                            style="width: 92px;"
                                                            aria-label="Name: activate to sort column ascending">EMPLOYEE NAME
                                                        </th> -->
                                                        <th class="sorting" tabindex="0"
                                                            aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                            style="width: 95px;"
                                                            aria-label="LEAVE: activate to sort column ascending">LEAVE
                                                            TYPE
                                                        </th>
                                                        <th class="sorting" tabindex="0"
                                                            aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                            style="width: 85px;"
                                                            aria-label="Date_From: activate to sort column ascending">
                                                            FROM
                                                        </th>
                                                        <th class="sorting" tabindex="0"
                                                            aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                            style="width: 85px;"
                                                            aria-label="Date_To: activate to sort column ascending">TO
                                                        </th>

                                                        <th class="sorting" tabindex="0"
                                                            aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                            style="width: 107px;"
                                                            aria-label="Reason: activate to sort column ascending">
                                                            REASON</th>
                                                        <th class="sorting_disabled" rowspan="1" colspan="1"
                                                            style="width: 117px;" aria-label="Actions">Actions</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                   <% if(data){ %>
                                                    <%for(let i=0 ; i< data.length ; i++){ %>
                                                        <tr>
                                                            <th>
                                                                <%=data[i].employee_Id %>
                                                            </th>
                                                            <th>
                                                                <%=data[i].leaveType %>
                                                            </th>
                                                            <th>
                                                                <%=data[i].from ? data[i].from.toLocaleDateString() : data[i].from %>
                                                            </th>
                                                            <th>
                                                                <%=data[i].to ? data[i].to.toLocaleDateString() : data[i].to %>
                                                            </th>
                                                            <th>
                                                                <%=data[i].reason %>
                                                            </th>
                                                            <th>
                                                                <div>
                                                                  <% if(data[i].action == "approved" ){%>
                                                                    <button id="<%=data[i]._id %>" onclick="approved('<%=data[i]._id %>')"
                                                                        class="btn btn-primary" disabled>Approved</button>
                                                                    <% }else if(data[i].action == "denied"){ %>
                                                                        <button onclick="denied('<%=data[i]._id %>')"
                                                                            class="btn btn-danger <%=data[i]._id %>" disabled>Denied</button>
                                                                        <% }else{ %>
                                                                            <button id="<%=data[i]._id %>" onclick="approved('<%=data[i]._id %>')"
                                                                                class="btn btn-primary">Approved</button>
                                                                            <button onclick="denied('<%=data[i]._id %>')"
                                                                                class="btn btn-danger <%=data[i]._id %>">Denied</button>
                                                                            <%}%>
                                                                   
                                                                </div>
                                                            </th>
                                                        </tr>
                                                        <%}}%>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Modal to add new record -->
                        </section>
                    </div>
                </div>
            </div>
            <!-- END: Content-->

            <div class="sidenav-overlay"></div>
            <div class="drag-target"></div>

            <!-- BEGIN: Footer-->
            <%-include("./partials/footer") %>
                <!-- END: Footer-->


                <!-- BEGIN: Vendor JS-->
                <%-include("./partials/scripts") %>

</body>
<!-- END: Body-->

</html>


<script>
   $(document).ready(function(){
        var dataTable = $('#leaveTable').DataTable({
    });
    });
    
</script>
<script>
    function approved(id) {
        $.ajax({
            url: "/view-leave-datatable",
            type: "GET",
            data: { id: id, message: "approved" },
            success: function (result) {
                console.log(result);
            }
        })
       $(`.${id}`).hide()
       $(`#${id}`).attr("disabled", true)
    }
    function denied(id) {
        $.ajax({
            url: "/view-leave-datatable",
            type: "GET",
            data: { id: id, message: "denied" },
            success: function (result) {
                console.log(result);
            }
        })
        $(`#${id}`).hide()
       $(`.${id}`).attr("disabled", true)
    }

</script>
